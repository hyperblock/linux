drivers/block/hyperblock/lsmt_ro_file.c:33:9: error: initializer element is not constant
         INVALID_OFFSET, 0, 0, 0, 0
         ^
drivers/block/hyperblock/lsmt_ro_file.c:33:9: note: (near initialization for ‘INVALID_MAPPING.offset’)
In file included from ./include/linux/printk.h:7:0,
                 from drivers/block/hyperblock/lsmt_ro_file.h:10,
                 from drivers/block/hyperblock/lsmt_ro_file.c:17:
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘print_segment’:
./include/linux/kern_levels.h:5:18: warning: format ‘%lu’ expects argument of type ‘long unsigned int’, but argument 2 has type ‘const long unsigned int:50’ [-Wformat=]
 #define KERN_SOH "\001"  /* ASCII Start Of Header */
                  ^
./include/linux/kern_levels.h:14:19: note: in expansion of macro ‘KERN_SOH’
 #define KERN_INFO KERN_SOH "6" /* informational */
                   ^
drivers/block/hyperblock/lsmt_ro_file.h:30:9: note: in expansion of macro ‘KERN_INFO’
  printk(KERN_INFO fmt, ## __VA_ARGS__);} while (0)
         ^
drivers/block/hyperblock/lsmt_ro_file.c:38:9: note: in expansion of macro ‘PRINT_INFO’
         PRINT_INFO("[ offset: %lu, length: %u ]\n", m->offset, m->length );
         ^
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘print_segment_mapping’:
./include/linux/kern_levels.h:5:18: warning: format ‘%lu’ expects argument of type ‘long unsigned int’, but argument 2 has type ‘const long unsigned int:50’ [-Wformat=]
 #define KERN_SOH "\001"  /* ASCII Start Of Header */
                  ^
./include/linux/kern_levels.h:14:19: note: in expansion of macro ‘KERN_SOH’
 #define KERN_INFO KERN_SOH "6" /* informational */
                   ^
drivers/block/hyperblock/lsmt_ro_file.h:30:9: note: in expansion of macro ‘KERN_INFO’
  printk(KERN_INFO fmt, ## __VA_ARGS__);} while (0)
         ^
drivers/block/hyperblock/lsmt_ro_file.c:43:9: note: in expansion of macro ‘PRINT_INFO’
         PRINT_INFO("[ offset: %lu, length: %u, moffset: %lu,"
         ^
./include/linux/kern_levels.h:5:18: warning: format ‘%lu’ expects argument of type ‘long unsigned int’, but argument 4 has type ‘const long unsigned int:55’ [-Wformat=]
 #define KERN_SOH "\001"  /* ASCII Start Of Header */
                  ^
./include/linux/kern_levels.h:14:19: note: in expansion of macro ‘KERN_SOH’
 #define KERN_INFO KERN_SOH "6" /* informational */
                   ^
drivers/block/hyperblock/lsmt_ro_file.h:30:9: note: in expansion of macro ‘KERN_INFO’
  printk(KERN_INFO fmt, ## __VA_ARGS__);} while (0)
         ^
drivers/block/hyperblock/lsmt_ro_file.c:43:9: note: in expansion of macro ‘PRINT_INFO’
         PRINT_INFO("[ offset: %lu, length: %u, moffset: %lu,"
         ^
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘verify_mapping_order’:
drivers/block/hyperblock/lsmt_ro_file.c:71:2: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
  const struct segment_mapping *it = pmappings;
  ^
In file included from ./include/linux/printk.h:7:0,
                 from drivers/block/hyperblock/lsmt_ro_file.h:10,
                 from drivers/block/hyperblock/lsmt_ro_file.c:17:
./include/linux/kern_levels.h:5:18: warning: format ‘%llu’ expects argument of type ‘long long unsigned int’, but argument 2 has type ‘const long unsigned int:50’ [-Wformat=]
 #define KERN_SOH "\001"  /* ASCII Start Of Header */
                  ^
./include/linux/kern_levels.h:11:18: note: in expansion of macro ‘KERN_SOH’
 #define KERN_ERR KERN_SOH "3" /* error conditions */
                  ^
drivers/block/hyperblock/lsmt_ro_file.h:34:9: note: in expansion of macro ‘KERN_ERR’
  printk(KERN_ERR fmt, ## __VA_ARGS__);} while (0)
         ^
drivers/block/hyperblock/lsmt_ro_file.c:76:17: note: in expansion of macro ‘PRINT_ERROR’
                 PRINT_ERROR("segment disordered. [%llu %llu] , [%llu %llu]",
                 ^
./include/linux/kern_levels.h:5:18: warning: format ‘%llu’ expects argument of type ‘long long unsigned int’, but argument 4 has type ‘const long unsigned int:50’ [-Wformat=]
 #define KERN_SOH "\001"  /* ASCII Start Of Header */
                  ^
./include/linux/kern_levels.h:11:18: note: in expansion of macro ‘KERN_SOH’
 #define KERN_ERR KERN_SOH "3" /* error conditions */
                  ^
drivers/block/hyperblock/lsmt_ro_file.h:34:9: note: in expansion of macro ‘KERN_ERR’
  printk(KERN_ERR fmt, ## __VA_ARGS__);} while (0)
         ^
drivers/block/hyperblock/lsmt_ro_file.c:76:17: note: in expansion of macro ‘PRINT_ERROR’
                 PRINT_ERROR("segment disordered. [%llu %llu] , [%llu %llu]",
                 ^
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘verify_mapping_moffset’:
./include/linux/kern_levels.h:5:18: warning: format ‘%llu’ expects argument of type ‘long long unsigned int’, but argument 2 has type ‘const long unsigned int:55’ [-Wformat=]
 #define KERN_SOH "\001"  /* ASCII Start Of Header */
                  ^
./include/linux/kern_levels.h:11:18: note: in expansion of macro ‘KERN_SOH’
 #define KERN_ERR KERN_SOH "3" /* error conditions */
                  ^
drivers/block/hyperblock/lsmt_ro_file.h:34:9: note: in expansion of macro ‘KERN_ERR’
  printk(KERN_ERR fmt, ## __VA_ARGS__);} while (0)
         ^
drivers/block/hyperblock/lsmt_ro_file.c:106:25: note: in expansion of macro ‘PRINT_ERROR’
                         PRINT_ERROR("invalid index moffset: "\
                         ^
In file included from drivers/block/hyperblock/lsmt_ro_file.c:17:0:
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘forward_offset_to’:
drivers/block/hyperblock/lsmt_ro_file.h:36:2: error: implicit declaration of function ‘BUG_ON’ [-Werror=implicit-function-declaration]
  BUG_ON(exp)
  ^
drivers/block/hyperblock/lsmt_ro_file.c:119:9: note: in expansion of macro ‘ASSERT’
         ASSERT(x >= s->offset);
         ^
drivers/block/hyperblock/lsmt_ro_file.c:120:9: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
         uint64_t delta = x - s->offset;
         ^
In file included from ./include/linux/printk.h:7:0,
                 from drivers/block/hyperblock/lsmt_ro_file.h:10,
                 from drivers/block/hyperblock/lsmt_ro_file.c:17:
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘backward_end_to’:
./include/linux/kern_levels.h:5:18: warning: format ‘%llu’ expects argument of type ‘long long unsigned int’, but argument 3 has type ‘long unsigned int:50’ [-Wformat=]
 #define KERN_SOH "\001"  /* ASCII Start Of Header */
                  ^
./include/linux/kern_levels.h:11:18: note: in expansion of macro ‘KERN_SOH’
 #define KERN_ERR KERN_SOH "3" /* error conditions */
                  ^
drivers/block/hyperblock/lsmt_ro_file.h:34:9: note: in expansion of macro ‘KERN_ERR’
  printk(KERN_ERR fmt, ## __VA_ARGS__);} while (0)
         ^
drivers/block/hyperblock/lsmt_ro_file.c:136:17: note: in expansion of macro ‘PRINT_ERROR’
                 PRINT_ERROR("%llu > %llu is FALSE", x, s->offset);
                 ^
drivers/block/hyperblock/lsmt_ro_file.c:138:9: error: implicit declaration of function ‘assert’ [-Werror=implicit-function-declaration]
         assert(x > s->offset);
         ^
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘create_memory_index’:
drivers/block/hyperblock/lsmt_ro_file.c:177:47: error: implicit declaration of function ‘kvmalloc’ [-Werror=implicit-function-declaration]
                 ret = (struct lsmt_ro_index *)kvmalloc(index_size);
                                               ^
drivers/block/hyperblock/lsmt_ro_file.c:177:23: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast]
                 ret = (struct lsmt_ro_index *)kvmalloc(index_size);
                       ^
In file included from ./include/linux/printk.h:7:0,
                 from drivers/block/hyperblock/lsmt_ro_file.h:10,
                 from drivers/block/hyperblock/lsmt_ro_file.c:17:
./include/linux/kern_levels.h:5:18: warning: format ‘%d’ expects argument of type ‘int’, but argument 2 has type ‘struct lsmt_ro_index *’ [-Wformat=]
 #define KERN_SOH "\001"  /* ASCII Start Of Header */
                  ^
./include/linux/kern_levels.h:11:18: note: in expansion of macro ‘KERN_SOH’
 #define KERN_ERR KERN_SOH "3" /* error conditions */
                  ^
drivers/block/hyperblock/lsmt_ro_file.h:34:9: note: in expansion of macro ‘KERN_ERR’
  printk(KERN_ERR fmt, ## __VA_ARGS__);} while (0)
         ^
drivers/block/hyperblock/lsmt_ro_file.c:183:25: note: in expansion of macro ‘PRINT_ERROR’
                         PRINT_ERROR("malloc memory failed with error code %d",ret);
                         ^
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘ro_index_lower_bound’:
drivers/block/hyperblock/lsmt_ro_file.c:218:9: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
         const struct segment_mapping *pret = index->pbegin + (ret + 1);
         ^
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘ro_index_lookup’:
drivers/block/hyperblock/lsmt_ro_file.c:232:9: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
         const struct segment_mapping *lb = ro_index_lower_bound(
         ^
drivers/block/hyperblock/lsmt_ro_file.c:236:9: error: ‘for’ loop initial declarations are only allowed in C99 or C11 mode
         for (const struct segment_mapping *it = lb; it != index->pend; it++) {
         ^
drivers/block/hyperblock/lsmt_ro_file.c:236:9: note: use option -std=c99, -std=gnu99, -std=c11 or -std=gnu11 to compile your code
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘do_load_index’:
drivers/block/hyperblock/lsmt_ro_file.c:335:21: error: storage size of ‘stat’ isn’t known
         struct stat stat;
                     ^
drivers/block/hyperblock/lsmt_ro_file.c:335:9: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
         struct stat stat;
         ^
drivers/block/hyperblock/lsmt_ro_file.c:340:19: error: implicit declaration of function ‘pread’ [-Werror=implicit-function-declaration]
         int ret = pread(fd, buf, HT_SPACE, 0);
                   ^
drivers/block/hyperblock/lsmt_ro_file.c:349:15: error: implicit declaration of function ‘fstat’ [-Werror=implicit-function-declaration]
         ret = fstat(fd, &stat);
               ^
drivers/block/hyperblock/lsmt_ro_file.c:394:9: error: implicit declaration of function ‘posix_memalign’ [-Werror=implicit-function-declaration]
         posix_memalign((void **)&ibuf, ALIGNMENT4K,
         ^
drivers/block/hyperblock/lsmt_ro_file.c:399:17: error: implicit declaration of function ‘free’ [-Werror=implicit-function-declaration]
                 free(ibuf);
                 ^
drivers/block/hyperblock/lsmt_ro_file.c:399:17: warning: incompatible implicit declaration of built-in function ‘free’
drivers/block/hyperblock/lsmt_ro_file.c:399:17: note: include ‘<stdlib.h>’ or provide a declaration of ‘free’
drivers/block/hyperblock/lsmt_ro_file.c:403:7: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
       size_t i; 
       ^
drivers/block/hyperblock/lsmt_ro_file.c:412:47: error: implicit declaration of function ‘malloc’ [-Werror=implicit-function-declaration]
         ret_index = (struct segment_mapping *)malloc(
                                               ^
drivers/block/hyperblock/lsmt_ro_file.c:412:47: warning: incompatible implicit declaration of built-in function ‘malloc’
drivers/block/hyperblock/lsmt_ro_file.c:412:47: note: include ‘<stdlib.h>’ or provide a declaration of ‘malloc’
drivers/block/hyperblock/lsmt_ro_file.c:417:9: warning: incompatible implicit declaration of built-in function ‘free’
         free(ibuf);
         ^
drivers/block/hyperblock/lsmt_ro_file.c:417:9: note: include ‘<stdlib.h>’ or provide a declaration of ‘free’
In file included from drivers/block/hyperblock/lsmt_ro_file.c:17:0:
drivers/block/hyperblock/lsmt_ro_file.c:420:43: error: ‘errno’ undeclared (first use in this function)
         PRINT_ERROR("errno: %d, msg: %s", errno, strerror(errno));
                                           ^
drivers/block/hyperblock/lsmt_ro_file.h:34:26: note: in definition of macro ‘PRINT_ERROR’
  printk(KERN_ERR fmt, ## __VA_ARGS__);} while (0)
                          ^
drivers/block/hyperblock/lsmt_ro_file.c:420:43: note: each undeclared identifier is reported only once for each function it appears in
         PRINT_ERROR("errno: %d, msg: %s", errno, strerror(errno));
                                           ^
drivers/block/hyperblock/lsmt_ro_file.h:34:26: note: in definition of macro ‘PRINT_ERROR’
  printk(KERN_ERR fmt, ## __VA_ARGS__);} while (0)
                          ^
drivers/block/hyperblock/lsmt_ro_file.c:420:50: error: implicit declaration of function ‘strerror’ [-Werror=implicit-function-declaration]
         PRINT_ERROR("errno: %d, msg: %s", errno, strerror(errno));
                                                  ^
drivers/block/hyperblock/lsmt_ro_file.h:34:26: note: in definition of macro ‘PRINT_ERROR’
  printk(KERN_ERR fmt, ## __VA_ARGS__);} while (0)
                          ^
drivers/block/hyperblock/lsmt_ro_file.c:335:21: warning: unused variable ‘stat’ [-Wunused-variable]
         struct stat stat;
                     ^
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘open_file’:
drivers/block/hyperblock/lsmt_ro_file.c:441:17: error: ‘errno’ undeclared (first use in this function)
                 errno = EIO;
                 ^
drivers/block/hyperblock/lsmt_ro_file.c:455:9: error: ‘for’ loop initial declarations are only allowed in C99 or C11 mode
         for (struct segment_mapping *it = (struct segment_mapping *)pi->pbegin; 
         ^
drivers/block/hyperblock/lsmt_ro_file.c:460:38: warning: incompatible implicit declaration of built-in function ‘malloc’
         rst = (struct lsmt_ro_file *)malloc(rst_size);
                                      ^
drivers/block/hyperblock/lsmt_ro_file.c:460:38: note: include ‘<stdlib.h>’ or provide a declaration of ‘malloc’
drivers/block/hyperblock/lsmt_ro_file.c:465:27: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
         rst->m_files[0] = (int)NULL;
                           ^
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘close_file’:
drivers/block/hyperblock/lsmt_ro_file.c:481:17: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
                 bool ok = true;
                 ^
drivers/block/hyperblock/lsmt_ro_file.c:483:17: error: ‘for’ loop initial declarations are only allowed in C99 or C11 mode
                 for (int i = 0; i < (int)((*file)->m_files_count); i++){
                 ^
drivers/block/hyperblock/lsmt_ro_file.c:486:35: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]
                         if (fd != (int)NULL && close(fd) != 0){
                                   ^
drivers/block/hyperblock/lsmt_ro_file.c:486:48: error: implicit declaration of function ‘close’ [-Werror=implicit-function-declaration]
                         if (fd != (int)NULL && close(fd) != 0){
                                                ^
In file included from drivers/block/hyperblock/lsmt_ro_file.c:17:0:
drivers/block/hyperblock/lsmt_ro_file.c:489:45: error: ‘errno’ undeclared (first use in this function)
                                         fd, errno, strerror(errno));
                                             ^
drivers/block/hyperblock/lsmt_ro_file.h:34:26: note: in definition of macro ‘PRINT_ERROR’
  printk(KERN_ERR fmt, ## __VA_ARGS__);} while (0)
                          ^
drivers/block/hyperblock/lsmt_ro_file.c:496:9: warning: incompatible implicit declaration of built-in function ‘free’
         free(*file);
         ^
drivers/block/hyperblock/lsmt_ro_file.c:496:9: note: include ‘<stdlib.h>’ or provide a declaration of ‘free’
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘merge_indexes’:
drivers/block/hyperblock/lsmt_ro_file.c:513:9: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
         struct segment_mapping *p = (struct segment_mapping *)
         ^
drivers/block/hyperblock/lsmt_ro_file.c:522:9: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
         struct segment_mapping it = *p;
         ^
drivers/block/hyperblock/lsmt_ro_file.c:541:49: error: implicit declaration of function ‘realloc’ [-Werror=implicit-function-declaration]
                                                 realloc(*mappings, tmp * 
                                                 ^
drivers/block/hyperblock/lsmt_ro_file.c:541:49: warning: incompatible implicit declaration of built-in function ‘realloc’
drivers/block/hyperblock/lsmt_ro_file.c:541:49: note: include ‘<stdlib.h>’ or provide a declaration of ‘realloc’
drivers/block/hyperblock/lsmt_ro_file.c:540:25: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
                         struct segment_mapping *m = (struct segment_mapping *)
                         ^
In file included from drivers/block/hyperblock/lsmt_ro_file.c:17:0:
drivers/block/hyperblock/lsmt_ro_file.c:545:41: error: ‘errno’ undeclared (first use in this function)
                                         errno, strerror(errno));
                                         ^
drivers/block/hyperblock/lsmt_ro_file.h:34:26: note: in definition of macro ‘PRINT_ERROR’
  printk(KERN_ERR fmt, ## __VA_ARGS__);} while (0)
                          ^
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘merge_memory_indexes’:
drivers/block/hyperblock/lsmt_ro_file.c:573:71: warning: incompatible implicit declaration of built-in function ‘malloc’
         struct segment_mapping *mappings = (struct segment_mapping *) malloc(
                                                                       ^
drivers/block/hyperblock/lsmt_ro_file.c:573:71: note: include ‘<stdlib.h>’ or provide a declaration of ‘malloc’
drivers/block/hyperblock/lsmt_ro_file.c:579:38: error: ‘UINT64_MAX’ undeclared (first use in this function)
                 &size, &capacity, 0, UINT64_MAX);
                                      ^
drivers/block/hyperblock/lsmt_ro_file.c:582:41: warning: incompatible implicit declaration of built-in function ‘realloc’
         tmp = (struct segment_mapping *)realloc(mappings, size * 
                                         ^
drivers/block/hyperblock/lsmt_ro_file.c:582:41: note: include ‘<stdlib.h>’ or provide a declaration of ‘realloc’
drivers/block/hyperblock/lsmt_ro_file.c:591:9: warning: incompatible implicit declaration of built-in function ‘free’
         free(mappings);
         ^
drivers/block/hyperblock/lsmt_ro_file.c:591:9: note: include ‘<stdlib.h>’ or provide a declaration of ‘free’
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘load_merge_index’:
drivers/block/hyperblock/lsmt_ro_file.c:605:2: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
  int i;
  ^
drivers/block/hyperblock/lsmt_ro_file.c:611:25: error: ‘errno’ undeclared (first use in this function)
                         errno = EIO;
                         ^
drivers/block/hyperblock/lsmt_ro_file.c:614:17: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
                 struct lsmt_ro_index *pi = create_memory_index(p, ht->index_size,
                 ^
drivers/block/hyperblock/lsmt_ro_file.c:621:25: warning: incompatible implicit declaration of built-in function ‘free’
                         free(p);
                         ^
drivers/block/hyperblock/lsmt_ro_file.c:621:25: note: include ‘<stdlib.h>’ or provide a declaration of ‘free’
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘lsmt_pread’:
drivers/block/hyperblock/lsmt_ro_file.c:652:9: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
         size_t readn = 0;
         ^
drivers/block/hyperblock/lsmt_ro_file.c:666:9: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
         struct segment s = { (uint64_t)offset / ALIGNMENT, 
         ^
drivers/block/hyperblock/lsmt_ro_file.c:673:17: error: ‘for’ loop initial declarations are only allowed in C99 or C11 mode
                 for (int i=0; i<n; i++){
                 ^
drivers/block/hyperblock/lsmt_ro_file.c:681:25: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
                         int fd = file->m_files[mapping[i].tag];
                         ^
In file included from drivers/block/hyperblock/lsmt_ro_file.c:17:0:
drivers/block/hyperblock/lsmt_ro_file.c:692:49: error: ‘errno’ undeclared (first use in this function)
                                                 errno, strerror(errno));
                                                 ^
drivers/block/hyperblock/lsmt_ro_file.h:34:26: note: in definition of macro ‘PRINT_ERROR’
  printk(KERN_ERR fmt, ## __VA_ARGS__);} while (0)
                          ^
drivers/block/hyperblock/lsmt_ro_file.c: In function ‘open_files’:
drivers/block/hyperblock/lsmt_ro_file.c:723:59: warning: incompatible implicit declaration of built-in function ‘malloc’
         struct lsmt_ro_file *ret = (struct lsmt_ro_file *)malloc(sizeof(int) * n
                                                           ^
drivers/block/hyperblock/lsmt_ro_file.c:723:59: note: include ‘<stdlib.h>’ or provide a declaration of ‘malloc’
drivers/block/hyperblock/lsmt_ro_file.c: At top level:
drivers/block/hyperblock/lsmt_ro_file.c:32:31: warning: ‘INVALID_MAPPING’ defined but not used [-Wunused-variable]
 static struct segment_mapping INVALID_MAPPING = {
                               ^
cc1: some warnings being treated as errors
make[3]: *** [drivers/block/hyperblock/lsmt_ro_file.o] Error 1
make[2]: *** [drivers/block/hyperblock] Error 2
make[2]: *** Waiting for unfinished jobs....
make[1]: *** [drivers/block] Error 2
make[1]: *** Waiting for unfinished jobs....
make: *** [drivers] Error 2
make: *** Waiting for unfinished jobs....
